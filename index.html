<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop GPT - Farmer's Dashboard</title>
     
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
                /* ===== CSS Variables for Theme Colors ===== */
        :root {
            --bg-dark: #f8f8f8;
            --bg-light: #ffffff;
            --primary-neon: #00dd00;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-glow-color: rgba(0, 221, 0, 0.7);
            --border-color: rgba(0, 221, 0, 0.3);
            --income-color: #28a745;
            --expense-color: #dc3545;
            --notification-unread-bg: #e6ffed;
        }

        /* ===== General Body & Reset Styles ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== Header Styling ===== */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: var(--bg-light);
            border-bottom: 1px solid var(--border-color);
        }

        .header .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header img {
            height: 40px;
        }

        .header h1 {
            color: var(--primary-neon);
            font-weight: 500;
            text-shadow: 0 0 5px var(--border-glow-color);
        }

        .header .header-icons {
            display: flex;
            gap: 25px;
            font-size: 1.5rem;
            color: var(--primary-neon);
        }

        .header .header-icons i {
            cursor: pointer;
            transition: transform 0.2s ease, text-shadow 0.2s ease;
            position: relative;
        }
        
        #notificationsBtn .notification-badge {
            position: absolute;
            top: -5px;
            right: -8px;
            background-color: var(--expense-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid var(--bg-light);
        }

        .header .header-icons i:hover {
            transform: scale(1.1);
            text-shadow: 0 0 8px var(--border-glow-color);
        }

        /* ===== Main 3-Column Container ===== */
        .container {
            display: flex;
            flex-grow: 1;
            gap: 20px;
            padding: 20px;
        }

        /* ===== General Neon Border Style ===== */
        .neon-border {
            border: 1px solid var(--border-color);
            box-shadow: 0 0 5px var(--border-glow-color);
            border-radius: 10px;
        }

        /* ===== Left Sidebar (Profile & Chat) ===== */
        .left-sidebar {
            width: 300px;
            flex-shrink: 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: var(--bg-light);
        }

        /* Profile Dropdown Styling */
        .profile-container {
            position: relative;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--bg-light);
            cursor: pointer;
            user-select: none;
        }

        .profile-icon {
            font-size: 2.5rem;
            color: var(--primary-neon);
        }

        .profile-section span {
            font-size: 1.2rem;
            font-weight: 500;
            flex-grow: 1;
        }

        .dropdown-arrow {
            font-size: 1rem;
            transition: transform 0.3s ease;
        }

        .profile-container.open .dropdown-arrow {
            transform: rotate(180deg);
        }

        .profile-dropdown {
            display: none;
            background-color: var(--bg-light);
            border-radius: 0 0 10px 10px;
            overflow: hidden;
            padding: 5px;
            margin-top: -5px;
            border: 1px solid var(--border-color);
            border-top: none;
            position: absolute;
            width: 100%;
            z-index: 100;
        }

        .profile-dropdown.show {
            display: block;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            color: var(--text-primary);
            text-decoration: none;
            transition: background-color 0.2s ease;
        }

        .dropdown-item:hover {
            background-color: rgba(0, 255, 0, 0.1);
        }

        /* Chats Section */
        .chats-section {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            background: var(--bg-light);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid var(--border-color);
        }

        .chats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .chats-header h2 {
            color: var(--primary-neon);
            font-weight: 500;
            font-size: 1.2rem;
        }

        #aiChatWindow {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px 5px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 200px; /* Ensure chat window has height */
        }

        .chat-message {
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 80%;
            line-height: 1.4;
        }

        .chat-message.user {
            background-color: #e9e9eb;
            align-self: flex-end;
            border-bottom-right-radius: 3px;
        }

        .chat-message.ai {
            background-color: #d1fcd1;
            align-self: flex-start;
            border-bottom-left-radius: 3px;
        }

        #aiChatForm {
            margin-top: auto;
            padding-top: 10px;
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex-grow: 1;
            padding: 10px;
            background-color: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }
         .ai-input:focus {
            outline: none;
            border-color: var(--primary-neon);
            box-shadow: 0 0 8px var(--border-glow-color);
        }

        .voice-btn {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            background-color: var(--primary-neon);
            color: #fff;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ===== Main Content (Dashboard) ===== */
        .main-content {
            flex-grow: 1;
        }

        .main-content h2 {
            margin-bottom: 20px;
            font-weight: 500;
            text-align: center;
            color: var(--primary-neon);
            font-size: 1.8rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .dashboard-item {
            background-color: var(--bg-light);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            height: 180px;
        }

        .dashboard-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 15px var(--border-glow-color), 0 0 25px var(--border-glow-color);
            border-color: var(--primary-neon);
        }

        .dashboard-item i {
            font-size: 2.8rem;
            color: var(--primary-neon);
        }

        .dashboard-item span {
            font-size: 1.2rem;
            font-weight: 500;
        }

        /* ===== Right Sidebar (Market Graph) ===== */
        .right-sidebar {
            width: 350px;
            flex-shrink: 0;
            padding: 15px;
            background-color: var(--bg-light);
        }

        .market-graph-container {
            background-color: var(--bg-light);
            padding: 20px;
            border-radius: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .market-graph-container h3 {
            text-align: center;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .chart-wrapper {
            position: relative;
            height: 250px;
            width: 100%;
            margin-bottom: 15px;
        }

        #marketPriceTableContainer {
            flex-grow: 1;
            overflow-y: auto;
        }
        .price-table {
            width: 100%;
            border-collapse: collapse;
        }
        .price-table th, .price-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .price-table th {
            font-weight: 500;
        }

        /* ===== Modal Styling ===== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--bg-light);
            margin: auto;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            position: relative;
            animation: modal-open 0.4s ease;
        }
        
        @keyframes modal-open {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal.show {
            display: flex;
        }

        .modal-lg .modal-content {
            max-width: 800px;
        }

        .modal-content h2 {
            text-align: center;
            color: var(--primary-neon);
            margin-bottom: 20px;
        }

        .close-btn {
            color: var(--text-secondary);
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-btn:hover {
            color: var(--text-primary);
        }

        /* Form Styling */
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; background-color: var(--bg-dark); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 5px; font-size: 1rem; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--primary-neon); box-shadow: 0 0 8px var(--border-glow-color); }
        .form-submit-btn { width: 100%; padding: 12px; background-color: var(--primary-neon); color: #fff; border: none; border-radius: 5px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 10px; transition: all 0.2s ease; }
        .form-submit-btn:hover { box-shadow: 0 0 15px var(--border-glow-color); }

        /* ===== Feature-Specific Styles ===== */

        /* Tab Navigation */
        .tab-nav { display: flex; border-bottom: 2px solid var(--border-color); margin-bottom: 20px; }
        .tab-btn { padding: 10px 20px; cursor: pointer; background: none; border: none; font-size: 1rem; font-weight: 500; color: var(--text-secondary); border-bottom: 2px solid transparent; margin-bottom: -2px; }
        .tab-btn.active { color: var(--primary-neon); border-bottom-color: var(--primary-neon); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Finance Manager */
        .finance-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .summary-card { background: var(--bg-dark); padding: 15px; border-radius: 8px; text-align: center; }
        .summary-card h4 { margin-bottom: 8px; font-weight: 500; }
        .summary-card p { font-size: 1.5rem; font-weight: bold; }
        #totalIncomeValue { color: var(--income-color); }
        #totalExpenseValue { color: var(--expense-color); }
        #netIncomeValue.positive { color: var(--income-color); }
        #netIncomeValue.negative { color: var(--expense-color); }
        #transactionList { list-style-type: none; padding: 0; max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 5px; padding: 10px;}
        #transactionList li { display: flex; justify-content: space-between; padding: 10px; border-radius: 5px; }
        #transactionList li:nth-child(odd) { background: var(--bg-dark); }
        .transaction-income span:last-child { color: var(--income-color); font-weight: bold; }
        .transaction-expense span:last-child { color: var(--expense-color); font-weight: bold; }
        .calculator-result { margin-top: 15px; padding: 15px; background: var(--bg-dark); border-radius: 5px; font-size: 1.2rem; text-align: center; font-weight: bold; }

        /* Crop Manager & Weather */
        #cropInfoDisplay, #weatherResultsContainer { margin-top: 20px; padding: 15px; background-color: var(--bg-dark); border-radius: 8px; min-height: 100px; }
        #cropInfoDisplay h3, #weatherResultsContainer h3 { color: var(--primary-neon); margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .crop-info-grid, .weather-grid-display { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .crop-info-item, .weather-grid-display .weather-card { background: var(--bg-light); padding: 10px; border-radius: 5px; }
        .crop-info-item strong, .weather-grid-display .weather-card strong { display: block; margin-bottom: 5px; }
        .weather-grid-display .full-width { grid-column: 1 / -1; }

        /* Govt Schemes */
        #schemesContainer { display: flex; flex-direction: column; gap: 15px; max-height: 500px; overflow-y: auto; padding-right: 10px;}
        .scheme-card { background: var(--bg-dark); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-neon); }
        .scheme-card h3 { margin-bottom: 8px; }

        /* Community Forum */
        #forumPostsContainer { max-height: 400px; overflow-y: auto; padding-right: 10px;}
        .forum-post { background: var(--bg-dark); padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .forum-post h3 { margin-bottom: 10px; }
        .answer-section { margin-top: 15px; padding-left: 20px; border-left: 2px solid var(--border-color); }
        .answer { background: var(--bg-light); padding: 10px; border-radius: 5px; margin-bottom: 10px; }
        .answer-form { margin-top: 10px; display: flex; gap: 10px; }
        .answer-form textarea { flex-grow: 1; min-height: 40px; }
        .answer-form button { padding: 0 15px; height: 45px; align-self: flex-end; }

        /* Farm Kart */
        #farmKartGrid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; max-height: 500px; overflow-y: auto; padding: 10px;}
        .product-card { background: var(--bg-light); border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; display: flex; flex-direction: column; justify-content: space-between; }
        .product-card img { width: 100%; height: 150px; object-fit: cover; }
        .product-info { padding: 15px; }
        .product-info h4 { font-size: 1rem; margin-bottom: 10px; height: 40px; }
        .product-info p { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; }
        .buy-now-btn { display: block; width: 100%; padding: 10px; background: var(--primary-neon); color: #fff; text-decoration: none; border-radius: 5px; font-weight: bold; }
        
        /* About Us & Notifications */
        .about-section p { margin-bottom: 15px; line-height: 1.6; }
        .about-section ul { list-style-position: inside; padding-left: 10px; }
        .about-section li { margin-bottom: 10px; }
        
        .notifications-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        #markAllReadBtn { background: none; border: 1px solid var(--primary-neon); color: var(--primary-neon); padding: 5px 10px; border-radius: 5px; cursor: pointer; }

        #notificationsList { max-height: 450px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .notification-item { display: flex; gap: 15px; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); }
        .notification-item.unread { background-color: var(--notification-unread-bg); border-left: 4px solid var(--primary-neon); }
        .notification-icon { font-size: 1.8rem; color: var(--primary-neon); }
        .notification-content { flex-grow: 1; }
        .notification-title { font-weight: bold; }
        .notification-message { font-size: 0.9rem; margin: 4px 0; }
        .notification-time { font-size: 0.8rem; color: var(--text-secondary); }
        .empty-state { text-align: center; padding: 40px 20px; color: var(--text-secondary); }

        /* Responsive */
        @media (max-width: 1200px) {
            .container { flex-direction: column; }
            .left-sidebar, .right-sidebar { width: 100%; }
        }
        @media (max-width: 768px) {
            .dashboard-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
            .header { flex-direction: column; gap: 10px; }
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="logo-container">
            <img src="logo.png" alt="Crop GPT Logo">
            <h1>Crop GPT</h1>
        </div>
        <div class="header-icons">
            <i id="notificationsBtn" class="fas fa-bell" title="Notifications"></i>
            <i id="aboutBtn" class="fas fa-info-circle" title="About Us"></i>
        </div>
    </header>

    <div class="container">
        <aside class="left-sidebar neon-border">
            <div class="profile-container">
                <div id="profileTrigger" class="profile-section neon-border">
                    <i class="fas fa-user-circle profile-icon"></i>
                    <span>Profile</span>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>
                <div id="profileDropdownMenu" class="profile-dropdown">
                    <a href="#" id="loginBtn" class="dropdown-item"><i class="fas fa-sign-in-alt"></i> Login</a>
                    <a href="#" id="signupBtn" class="dropdown-item"><i class="fas fa-user-plus"></i> Sign Up</a>
                </div>
            </div>
            
            <div class="chats-section">
                <div class="chats-header">
                    <h2>AI Chat</h2>
                </div>
                <div id="aiChatWindow">
                    <div class="chat-message ai">Hello! Ask me about farming, crops, or schemes.</div>
                </div>
                <form id="aiChatForm" class="ai-input-area">
                    <input type="text" id="ai-input" class="ai-input" placeholder="Ask AI....">
                    <button type="submit" class="voice-btn" title="Send"><i class="fas fa-paper-plane"></i></button>
                </form>
            </div>
        </aside>

        <main class="main-content">
            <h2>Dashboard</h2>
            <div class="dashboard-grid">
                <div id="weatherDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-cloud-sun-rain"></i><span>Weather Alerts</span></div>
                <div id="financeDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-wallet"></i><span>Finance Manager</span></div>
                <div id="cropDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-seedling"></i><span>Crop Manager</span></div>
                <div id="schemesDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-landmark"></i><span>Govt Schemes</span></div>
                <div id="communityDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-users"></i><span>Community</span></div>
                <div id="farmKartDashboardBtn" class="dashboard-item neon-border"><i class="fas fa-shopping-cart"></i><span>Farm Kart</span></div>
            </div>
        </main>

        <aside class="right-sidebar neon-border">
            <div class="market-graph-container">
                <h3>Market Data</h3>
                <div class="form-group">
                    <label for="districtMarketSelector">Select District:</label>
                    <select id="districtMarketSelector"></select>
                </div>
                <div class="chart-wrapper">
                    <canvas id="marketChart"></canvas>
                </div>
                <div id="marketPriceTableContainer"></div>
            </div>
        </aside>
    </div>

    <!-- ===== ALL MODALS ===== -->
    <div id="loginModal" class="modal">
        <div class="modal-content neon-border">
            <span class="close-btn">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group"><label for="loginMobile">Mobile Number</label><input id="loginMobile" type="tel" placeholder="Enter your 10-digit mobile number" pattern="[0-9]{10}" required></div>
                <div class="form-group"><label for="loginPassword">Password</label><input id="loginPassword" type="password" placeholder="Enter your password" required></div>
                <button type="submit" class="form-submit-btn">Login</button>
            </form>
        </div>
    </div>

    <div id="signupModal" class="modal">
        <div class="modal-content neon-border">
            <span class="close-btn">&times;</span>
            <h2>Create Account</h2>
            <form id="signupForm">
                <div class="form-group"><label>Name</label><input type="text" placeholder="Full Name" required></div>
                <div class="form-group"><label>Number</label><input type="tel" placeholder="10-digit mobile number" pattern="[0-9]{10}" required></div>
                <div class="form-group"><label>Password</label><input type="password" placeholder="Create a strong password" required></div>
                <div class="form-group"><label>Location</label><input type="text" placeholder="e.g., Cuttack" required></div>
                <div class="form-group"><label>Scale of Farmer</label><select required><option value="" disabled selected>-- Select Scale --</option><option value="small">Small-scale</option><option value="medium">Medium-scale</option><option value="large">Large-scale</option></select></div>
                <div class="form-group"><label>Address</label><textarea placeholder="Full Address" rows="3" required></textarea></div>
                <div class="form-group"><label>Pincode</label><input type="text" placeholder="6-digit Pincode" pattern="\d{6}" required></div>
                <button type="submit" class="form-submit-btn">Sign Up</button>
            </form>
        </div>
    </div>

    <div id="weatherModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Weather & Farm Advisory</h2><div class="form-group"><input type="text" id="districtSearchInput" placeholder="Search for a district in Odisha..."></div><div id="weatherResultsContainer"><p>Search for a district to see details.</p></div></div></div>
    <div id="financeModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Finance Manager</h2><div class="tab-nav"><button class="tab-btn active" data-tab="summaryTab">Summary & Transactions</button><button class="tab-btn" data-tab="profitTab">Profit Calculator</button><button class="tab-btn" data-tab="emiTab">Loan EMI Calculator</button></div><div id="summaryTab" class="tab-content active"><h3>Financial Overview</h3><div class="finance-summary"><div class="summary-card"><h4 >Total Income</h4><p id="totalIncomeValue">₹0.00</p></div><div class="summary-card"><h4 >Total Expense</h4><p id="totalExpenseValue">₹0.00</p></div><div class="summary-card"><h4 >Net Income</h4><p id="netIncomeValue">₹0.00</p></div></div><hr style="margin: 20px 0;"><form id="transactionForm"><h3>Add New Transaction</h3><div class="form-group"><label for="transactionType">Type</label><select id="transactionType"><option value="income">Income</option><option value="expense">Expense</option></select></div><div class="form-group"><label for="transactionDesc">Description</label><input id="transactionDesc" type="text" placeholder="e.g., Sold 10 quintals of rice" required></div><div class="form-group"><label for="transactionAmount">Amount (₹)</label><input id="transactionAmount" type="number" placeholder="e.g., 22000" required></div><button type="submit" class="form-submit-btn">Add Transaction</button></form><h4 style="margin-top:20px;">Transaction History</h4><ul id="transactionList"><li>No transactions yet.</li></ul></div><div id="profitTab" class="tab-content"><h3>Profit Calculator</h3><form id="profitCalcForm"><div class="form-group"><label for="totalRevenue">Total Revenue (₹)</label><input id="totalRevenue" type="number" placeholder="e.g., 50000" required></div><div class="form-group"><label for="totalCosts">Total Costs (₹)</label><input id="totalCosts" type="number" placeholder="e.g., 25000" required></div><button type="submit" class="form-submit-btn">Calculate Profit</button></form><div id="profitResult" class="calculator-result" style="display:none;"></div></div><div id="emiTab" class="tab-content"><h3>Loan EMI Calculator</h3><form id="emiCalcForm"><div class="form-group"><label for="loanAmount">Loan Amount (₹)</label><input id="loanAmount" type="number" placeholder="e.g., 100000" required></div><div class="form-group"><label for="interestRate">Annual Interest Rate (%)</label><input id="interestRate" type="number" step="0.01" placeholder="e.g., 8.5" required></div><div class="form-group"><label for="loanTenure">Loan Tenure (in Years)</label><input id="loanTenure" type="number" placeholder="e.g., 5" required></div><button type="submit" class="form-submit-btn">Calculate EMI</button></form><div id="emiResult" class="calculator-result" style="display:none;"></div></div></div></div>
    <div id="cropModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Crop Manager</h2><div class="form-group"><label for="cropSelector">Select a Crop to get detailed information:</label><select id="cropSelector"><option value="" disabled selected>-- Select a Crop --</option></select></div><div id="cropInfoDisplay"><p>Select a crop from the dropdown to see its details.</p></div></div></div>
    <div id="schemesModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Government Schemes for Farmers</h2><div id="schemesContainer"></div></div></div>
    <div id="communityModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Community Forum</h2><h3>Ask a New Question</h3><form id="askQuestionForm"><div class="form-group"><label for="questionTitle">Question Title</label><input id="questionTitle" type="text" placeholder="e.g., Best fertilizer for tomatoes?" required></div><div class="form-group"><label for="questionBody">Details</label><textarea id="questionBody" placeholder="Provide more details about your question..." rows="4" required></textarea></div><button type="submit" class="form-submit-btn">Post Question</button></form><hr style="margin: 20px 0;"><h3 >Recent Posts</h3><div id="forumPostsContainer"></div></div></div>
    <div id="farmKartModal" class="modal modal-lg"><div class="modal-content neon-border"><span class="close-btn">&times;</span><h2>Farm Kart - Essentials</h2><div id="farmKartGrid"></div></div></div>

    <!-- ===== NEW: NOTIFICATIONS MODAL ===== -->
    <div id="notificationsModal" class="modal modal-lg">
        <div class="modal-content neon-border">
            <span class="close-btn">&times;</span>
            <div class="notifications-header">
                <h2>Notifications</h2>
                <button id="markAllReadBtn">Mark all as read</button>
            </div>
            <div id="notificationsList">
                <!-- Notifications will be dynamically inserted here -->
            </div>
        </div>
    </div>
    
    <!-- ===== NEW: ABOUT US MODAL ===== -->
    <div id="aboutModal" class="modal">
        <div class="modal-content neon-border about-section">
            <span class="close-btn">&times;</span>
            <h2>About Crop GPT</h2>
            <p><strong>Our Mission:</strong> To empower the farmers of Odisha with modern technology, real-time data, and a supportive community, helping to increase yield, improve financial stability, and promote sustainable agricultural practices.</p>
            <h3>Key Features:</h3>
            <ul>
                <li><strong>AI Chat Assistant:</strong> Get instant answers to your farming questions.</li>
                <li><strong>Hyperlocal Weather Alerts:</strong> Detailed weather and crop advisories for every district in Odisha.</li>
                <li><strong>Comprehensive Management Tools:</strong> Manage your finances, crops, and learn about government schemes all in one place.</li>
                <li><strong>Farmer Community:</strong> Connect with fellow farmers to ask questions and share knowledge.</li>
            </ul>
             <p style="margin-top:20px; text-align:center; color: var(--text-secondary);">Contact us: support@cropgpt.com</p>
        </div>
    </div>
    
<script>
document.addEventListener('DOMContentLoaded', () => {

    // ===== DATA STORE =====
    const odishaDistricts = [ { name: "Angul", temp: "31°C", soil: "Red and Yellow, Laterite", idealCrops: "Rice, Pulses, Maize, Groundnut", wind: "10 km/h", humidity: "78%", rain: "40% chance of showers" }, { name: "Balangir", temp: "32°C", soil: "Red and Laterite", idealCrops: "Rice, Cotton, Sugarcane, Maize", wind: "12 km/h", humidity: "75%", rain: "30% chance of rain" }, { name: "Balasore", temp: "30°C", soil: "Coastal Alluvial, Saline", idealCrops: "Rice, Groundnut, Vegetables, Coconut", wind: "15 km/h", humidity: "82%", rain: "60% chance of thunderstorms" }, { name: "Bargarh", temp: "32°C", soil: "Mixed Red and Black", idealCrops: "Rice, Pulses, Groundnut, Sugarcane", wind: "11 km/h", humidity: "76%", rain: "35% chance of rain" }, { name: "Bhadrak", temp: "30°C", soil: "Alluvial, Saline", idealCrops: "Rice, Jute, Pulses, Oilseeds", wind: "14 km/h", humidity: "83%", rain: "55% chance of showers" }, { name: "Boudh", temp: "31°C", soil: "Red and Yellow", idealCrops: "Rice, Pulses, Oilseeds, Maize", wind: "9 km/h", humidity: "77%", rain: "40% chance of rain" }, { name: "Cuttack", temp: "31°C", soil: "Alluvial, Laterite", idealCrops: "Rice, Jute, Sugarcane, Vegetables", wind: "13 km/h", humidity: "80%", rain: "50% chance of showers" }, { name: "Deogarh", temp: "30°C", soil: "Red and Laterite", idealCrops: "Rice, Maize, Pulses, Turmeric", wind: "8 km/h", humidity: "79%", rain: "45% chance of rain" }, { name: "Dhenkanal", temp: "31°C", soil: "Red Loamy, Laterite", idealCrops: "Rice, Mango, Cashew, Vegetables", wind: "10 km/h", humidity: "78%", rain: "40% chance of rain" }, { name: "Gajapati", temp: "29°C", soil: "Hilly Red Soil, Laterite", idealCrops: "Maize, Cotton, Ginger, Turmeric", wind: "12 km/h", humidity: "81%", rain: "65% chance of heavy rain" }, { name: "Ganjam", temp: "30°C", soil: "Coastal Alluvial, Red Loamy", idealCrops: "Rice, Sugarcane, Coconut, Groundnut", wind: "16 km/h", humidity: "84%", rain: "60% chance of showers" }, { name: "Jagatsinghpur", temp: "30°C", soil: "Deltaic Alluvial, Saline", idealCrops: "Rice, Jute, Betel Vine, Sugarcane", wind: "15 km/h", humidity: "85%", rain: "55% chance of thunderstorms" }, { name: "Jajpur", temp: "31°C", soil: "Alluvial", idealCrops: "Rice, Jute, Groundnut, Mung", wind: "13 km/h", humidity: "82%", rain: "50% chance of rain" }, { name: "Jharsuguda", temp: "32°C", soil: "Red and Yellow", idealCrops: "Rice, Pulses, Groundnut", wind: "10 km/h", humidity: "74%", rain: "30% chance of rain" }, { name: "Kalahandi", temp: "31°C", soil: "Black and Red", idealCrops: "Rice, Cotton, Maize, Pulses", wind: "11 km/h", humidity: "76%", rain: "35% chance of rain" }, { name: "Kandhamal", temp: "28°C", soil: "Brown Forest, Red Loamy", idealCrops: "Turmeric, Ginger, Maize, Pulses", wind: "9 km/h", humidity: "80%", rain: "70% chance of rain" }, { name: "Kendrapara", temp: "30°C", soil: "Coastal Alluvial, Saline", idealCrops: "Rice, Jute, Coconut, Vegetables", wind: "14 km/h", humidity: "86%", rain: "60% chance of showers" }, { name: "Kendujhar (Keonjhar)", temp: "29°C", soil: "Red Soil, Laterite", idealCrops: "Rice, Maize, Pulses, Mango", wind: "8 km/h", humidity: "79%", rain: "50% chance of rain" }, { name: "Khordha", temp: "31°C", soil: "Laterite, Alluvial", idealCrops: "Rice, Cashew, Coconut, Vegetables", wind: "14 km/h", humidity: "81%", rain: "45% chance of thunderstorms" }, { name: "Koraput", temp: "27°C", soil: "Red Loamy, Brown Forest", idealCrops: "Coffee, Ginger, Millets, Vegetables", wind: "10 km/h", humidity: "83%", rain: "75% chance of rain" }, { name: "Malkangiri", temp: "30°C", soil: "Red and Laterite", idealCrops: "Rice, Maize, Pulses, Oilseeds", wind: "9 km/h", humidity: "80%", rain: "65% chance of rain" }, { name: "Mayurbhanj", temp: "29°C", soil: "Red Loamy, Laterite", idealCrops: "Rice, Sabai Grass, Pulses, Groundnut", wind: "10 km/h", humidity: "82%", rain: "55% chance of showers" }, { name: "Nabarangpur", temp: "29°C", soil: "Laterite, Red Sandy", idealCrops: "Maize, Rice, Millets, Pulses", wind: "8 km/h", humidity: "78%", rain: "60% chance of rain" }, { name: "Nayagarh", temp: "31°C", soil: "Red and Laterite", idealCrops: "Rice, Sugarcane, Pulses, Mango", wind: "12 km/h", humidity: "79%", rain: "40% chance of rain" }, { name: "Nuapada", temp: "32°C", soil: "Red and Yellow", idealCrops: "Rice, Maize, Pulses, Groundnut", wind: "10 km/h", humidity: "75%", rain: "30% chance of rain" }, { name: "Puri", temp: "30°C", soil: "Coastal Alluvial, Sandy", idealCrops: "Rice, Coconut, Casuarina, Vegetables", wind: "17 km/h", humidity: "85%", rain: "65% chance of showers" }, { name: "Rayagada", temp: "29°C", soil: "Hilly Red and Black", idealCrops: "Cotton, Maize, Millets, Pineapple", wind: "11 km/h", humidity: "81%", rain: "70% chance of rain" }, { name: "Sambalpur", temp: "32°C", soil: "Red and Yellow", idealCrops: "Rice, Pulses, Oilseeds, Sugarcane", wind: "11 km/h", humidity: "77%", rain: "35% chance of rain" }, { name: "Subarnapur (Sonepur)", temp: "32°C", soil: "Alluvial, Red and Black", idealCrops: "Rice, Pulses, Groundnut, Cotton", wind: "10 km/h", humidity: "76%", rain: "30% chance of rain" }, { name: "Sundargarh", temp: "30°C", soil: "Red Loamy, Laterite", idealCrops: "Rice, Groundnut, Vegetables, Pulses", wind: "9 km/h", humidity: "78%", rain: "45% chance of rain" } ];
    const cropData = { rice: { name: "Rice (Paddy)", soil: "Clayey and loamy soils", fertilizer: "Nitrogen (Urea), Phosphorus, Potassium", watering: "Requires standing water (2-5 cm), frequent irrigation", harvest: "Approx. 90-120 days after planting" }, maize: { name: "Maize (Corn)", soil: "Well-drained loamy soils", fertilizer: "High Nitrogen, Phosphorus", watering: "Once every 5-7 days during peak growth", harvest: "Approx. 60-100 days, when silks are dry" }, sugarcane: { name: "Sugarcane", soil: "Loamy, well-drained soils", fertilizer: "NPK complex, pressmud", watering: "Frequent watering, especially during formative stage", harvest: "Approx. 10-18 months" }, cotton: { name: "Cotton", soil: "Black cotton soil, well-drained", fertilizer: "Nitrogen and Phosphorus", watering: "Infrequent but deep watering", harvest: "Approx. 150-180 days" }, groundnut: { name: "Groundnut (Peanut)", soil: "Sandy loam soils", fertilizer: "Phosphorus, Potassium, Gypsum", watering: "Every 8-10 days, avoid waterlogging", harvest: "Approx. 90-130 days" }, };
    const govtSchemes = [ { title: "KALIA (Krushak Assistance for Livelihood and Income Augmentation)", description: "Provides financial support to small and marginal farmers for cultivation, livelihood, and insurance." }, { title: "PM-KISAN (Pradhan Mantri Kisan Samman Nidhi)", description: "A central government scheme providing an income support of ₹6,000 per year in three equal installments to all landholding farmer families." }, { title: "Balaram Yojana", description: "Aims to provide agricultural credit to landless farmers through Joint Liability Groups (JLGs)." }, { title: "Odisha Millets Mission (OMM)", description: "Promotes the cultivation and consumption of millets, providing technical support and market linkages to farmers." } ];
    const farmProducts = [ { name: 'Urea Fertilizer (45kg Bag)', price: '₹266', image: 'https://placehold.co/200x150/28a745/ffffff?text=Urea', url: '#' }, { name: 'Organic Vermicompost (5kg)', price: '₹299', image: 'https://placehold.co/200x150/8B4513/ffffff?text=Compost', url: '#' }, { name: 'Paddy Seeds (1kg)', price: '₹150', image: 'https://placehold.co/200x150/DAA520/ffffff?text=Seeds', url: '#' }, { name: 'Gardening Tool Set', price: '₹499', image: 'https://placehold.co/200x150/696969/ffffff?text=Tools', url: '#' }, { name: 'Neem Oil Pesticide (1L)', price: '₹550', image: 'https://placehold.co/200x150/556B2F/ffffff?text=Neem+Oil', url: '#' }, { name: 'Water Sprayer Pump (2L)', price: '₹349', image: 'https://placehold.co/200x150/4682B4/ffffff?text=Sprayer', url: '#' } ];
    const marketData = { Sambalpur: { chartData: { labels: ['Paddy', 'Pulses', 'Oilseeds'], datasets: [{ label: 'Demand', data: [85, 60, 50], backgroundColor: 'rgba(75, 192, 192, 0.5)' }, { label: 'Supply', data: [75, 65, 45], backgroundColor: 'rgba(255, 159, 64, 0.5)' }] }, prices: [{ crop: 'Paddy (Common)', price: '₹2183' }, { crop: 'Arhar (Pulses)', price: '₹7000' }, { crop: 'Groundnut (Oilseed)', price: '₹6377' }] }, Cuttack: { chartData: { labels: ['Paddy', 'Jute', 'Sugarcane'], datasets: [{ label: 'Demand', data: [90, 70, 60], backgroundColor: 'rgba(75, 192, 192, 0.5)' }, { label: 'Supply', data: [80, 65, 65], backgroundColor: 'rgba(255, 159, 64, 0.5)' }] }, prices: [{ crop: 'Paddy (Common)', price: '₹2190' }, { crop: 'Jute', price: '₹5050' }, { crop: 'Sugarcane', price: '₹3500' }] }, Bargarh: { chartData: { labels: ['Paddy', 'Groundnut', 'Pulses'], datasets: [{ label: 'Demand', data: [95, 55, 65], backgroundColor: 'rgba(75, 192, 192, 0.5)' }, { label: 'Supply', data: [90, 50, 60], backgroundColor: 'rgba(255, 159, 64, 0.5)' }] }, prices: [{ crop: 'Paddy (Grade A)', price: '₹2203' }, { crop: 'Groundnut', price: '₹6400' }, { crop: 'Mung (Pulses)', price: '₹8558' }] } };
    
    let notifications = [
        { id: 1, icon: 'fa-cloud-showers-heavy', title: 'Weather Alert: Sambalpur', message: 'Heavy rainfall expected in the next 48 hours. Please take necessary precautions for your crops.', timestamp: new Date('2025-10-03T20:00:00'), read: false },
        { id: 2, icon: 'fa-landmark', title: 'PM-KISAN Scheme', message: 'The next installment is scheduled to be released by October 15th. Ensure your eKYC is complete.', timestamp: new Date('2025-10-03T09:30:00'), read: false },
        { id: 3, icon: 'fa-chart-line', title: 'Market Price Update', message: 'Paddy prices in Sambalpur market have increased by 2%. Current price is ₹2183/Quintal.', timestamp: new Date('2025-10-02T18:00:00'), read: true },
        { id: 4, icon: 'fa-users', title: 'New Community Post', message: 'A farmer asked a new question about organic pesticides for rice. Join the discussion!', timestamp: new Date('2025-10-01T15:12:00'), read: true },
    ];
    
    let transactions = [];
    let communityPosts = [{ id: 1, title: "Best organic pesticide for rice stem borer?", body: "I'm looking for effective organic or homemade pesticides to control stem borer infestation in my paddy field. Any suggestions?", answers: [{ text: "Try a neem oil solution. Mix 5ml of neem oil and 1ml of liquid soap in 1 liter of water and spray it." }] }];
    
    const allModals = document.querySelectorAll('.modal');
    const closeButtons = document.querySelectorAll('.close-btn');
    let marketChart;
    
    const openModal = (modal) => { if (modal) modal.classList.add('show'); };
    const closeModal = (modal) => { if (modal) modal.classList.remove('show'); };

    // ===== EVENT LISTENERS SETUP =====
    document.getElementById('profileTrigger').addEventListener('click', (e) => { e.stopPropagation(); document.getElementById('profileDropdownMenu').classList.toggle('show'); document.querySelector('.profile-container').classList.toggle('open'); });
    window.addEventListener('click', () => { document.getElementById('profileDropdownMenu').classList.remove('show'); document.querySelector('.profile-container').classList.remove('open'); });
    document.getElementById('loginBtn').addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('loginModal')); });
    document.getElementById('signupBtn').addEventListener('click', (e) => { e.preventDefault(); openModal(document.getElementById('signupModal')); });
    
    // Header icon listeners
    document.getElementById('notificationsBtn').addEventListener('click', () => openModal(document.getElementById('notificationsModal')));
    document.getElementById('aboutBtn').addEventListener('click', () => openModal(document.getElementById('aboutModal')));
    
    // Dashboard buttons
    document.getElementById('weatherDashboardBtn').addEventListener('click', () => openModal(document.getElementById('weatherModal')));
    document.getElementById('financeDashboardBtn').addEventListener('click', () => openModal(document.getElementById('financeModal')));
    document.getElementById('cropDashboardBtn').addEventListener('click', () => openModal(document.getElementById('cropModal')));
    document.getElementById('schemesDashboardBtn').addEventListener('click', () => openModal(document.getElementById('schemesModal')));
    document.getElementById('communityDashboardBtn').addEventListener('click', () => openModal(document.getElementById('communityModal')));
    document.getElementById('farmKartDashboardBtn').addEventListener('click', () => openModal(document.getElementById('farmKartModal')));

    closeButtons.forEach(btn => btn.addEventListener('click', () => closeModal(btn.closest('.modal'))));
    allModals.forEach(modal => modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(modal); }));

    // ===== AI CHAT LOGIC =====
    const aiChatForm = document.getElementById('aiChatForm');
    const aiChatInput = document.getElementById('ai-input');
    const aiChatWindow = document.getElementById('aiChatWindow');
    const aiResponses = { "weather": "You can check the weather for any district in Odisha by clicking on the 'Weather Alerts' button on the dashboard.", "fertilizer": "For rice, a mix of Nitrogen, Phosphorus, and Potassium is recommended. For specific advice, please select the crop in the 'Crop Manager' section.", "rice": "Rice grows best in clayey and loamy soils. It needs regular watering and is typically harvested in 90-120 days. Check the Crop Manager for more details.", "kalia": "The KALIA scheme provides financial aid to farmers in Odisha for cultivation and livelihood. You can find more details in the 'Govt Schemes' section.", "loan": "You can calculate your loan EMI using the 'Loan EMI Calculator' in the 'Finance Manager'.", "profit": "To calculate your profit, go to the 'Finance Manager' and use the 'Profit Calculator' tab.", "default": "I can answer questions about weather, fertilizer, loans, profits, and schemes like KALIA. Please try asking one of those." };
    aiChatForm.addEventListener('submit', (e) => { e.preventDefault(); const userMessage = aiChatInput.value.trim(); if (!userMessage) return; appendMessage(userMessage, 'user'); aiChatInput.value = ''; setTimeout(() => appendMessage(getAiResponse(userMessage), 'ai'), 500); });
    function appendMessage(message, type) { const msgEl = document.createElement('div'); msgEl.className = `chat-message ${type}`; msgEl.textContent = message; aiChatWindow.appendChild(msgEl); aiChatWindow.scrollTop = aiChatWindow.scrollHeight; }
    function getAiResponse(message) { const msg = message.toLowerCase(); for (const keyword in aiResponses) if (msg.includes(keyword)) return aiResponses[keyword]; return aiResponses['default']; }

    // ===== FINANCE MANAGER LOGIC =====
    const financeTabs = document.querySelectorAll('#financeModal .tab-btn');
    financeTabs.forEach(tab => tab.addEventListener('click', () => { document.querySelector('#financeModal .tab-btn.active').classList.remove('active'); document.querySelector('#financeModal .tab-content.active').classList.remove('active'); tab.classList.add('active'); document.getElementById(tab.dataset.tab).classList.add('active'); }));
    document.getElementById('transactionForm').addEventListener('submit', e => { e.preventDefault(); transactions.push({ type: document.getElementById('transactionType').value, desc: document.getElementById('transactionDesc').value, amount: parseFloat(document.getElementById('transactionAmount').value) }); updateFinanceSummary(); renderTransactions(); e.target.reset(); });
    document.getElementById('profitCalcForm').addEventListener('submit', e => { e.preventDefault(); const profit = parseFloat(document.getElementById('totalRevenue').value) - parseFloat(document.getElementById('totalCosts').value); const resultEl = document.getElementById('profitResult'); resultEl.textContent = `Net Profit: ₹${profit.toFixed(2)}`; resultEl.style.display = 'block'; });
    document.getElementById('emiCalcForm').addEventListener('submit', e => { e.preventDefault(); const p = parseFloat(document.getElementById('loanAmount').value), r = (parseFloat(document.getElementById('interestRate').value) / 12) / 100, n = parseFloat(document.getElementById('loanTenure').value) * 12; const emi = (p * r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1); const resultEl = document.getElementById('emiResult'); resultEl.textContent = `Monthly EMI: ₹${emi.toFixed(2)}`; resultEl.style.display = 'block'; });
    function updateFinanceSummary() { const income = transactions.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0); const expense = transactions.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0); const net = income - expense; document.getElementById('totalIncomeValue').textContent = `₹${income.toFixed(2)}`; document.getElementById('totalExpenseValue').textContent = `₹${expense.toFixed(2)}`; const netEl = document.getElementById('netIncomeValue'); netEl.textContent = `₹${net.toFixed(2)}`; netEl.className = net >= 0 ? 'positive' : 'negative'; }
    function renderTransactions() { const list = document.getElementById('transactionList'); list.innerHTML = transactions.length === 0 ? '<li>No transactions yet.</li>' : transactions.map(t => `<li class="transaction-${t.type}"><span>${t.desc}</span> <span>${t.type === 'income' ? '+' : '-'}₹${t.amount.toFixed(2)}</span></li>`).reverse().join(''); }
    
    // ===== CROP MANAGER LOGIC =====
    const cropSelector = document.getElementById('cropSelector');
    Object.keys(cropData).forEach(key => { const option = document.createElement('option'); option.value = key; option.textContent = cropData[key].name; cropSelector.appendChild(option); });
    cropSelector.addEventListener('change', e => { const data = cropData[e.target.value]; const display = document.getElementById('cropInfoDisplay'); if (!data) { display.innerHTML = `<p>Select a crop from the dropdown to see its details.</p>`; return; } display.innerHTML = `<h3>${data.name} Guide</h3><div class="crop-info-grid"><div class="crop-info-item"><strong>Soil Type:</strong> ${data.soil}</div><div class="crop-info-item"><strong>Fertilizer:</strong> ${data.fertilizer}</div><div class="crop-info-item"><strong>Watering:</strong> ${data.watering}</div><div class="crop-info-item"><strong>Harvest Time:</strong> ${data.harvest}</div></div>`; });

    // ===== GOVT SCHEMES LOGIC =====
    document.getElementById('schemesContainer').innerHTML = govtSchemes.map(s => `<div class="scheme-card"><h3>${s.title}</h3><p>${s.description}</p></div>`).join('');
    
    // ===== COMMUNITY FORUM LOGIC =====
    const forumPostsContainer = document.getElementById('forumPostsContainer');
    function renderPosts() { forumPostsContainer.innerHTML = communityPosts.map(post => `<div class="forum-post"><h3>${post.title}</h3><p>${post.body}</p><div class="answer-section"><h4>Answers:</h4>${post.answers.length > 0 ? post.answers.map(ans => `<div class="answer">${ans.text}</div>`).join('') : '<p>No answers yet.</p>'}<form class="answer-form" data-post-id="${post.id}"><textarea placeholder="Write your answer..." required></textarea><button type="submit" class="form-submit-btn">Reply</button></form></div></div>`).join(''); }
    document.getElementById('askQuestionForm').addEventListener('submit', e => { e.preventDefault(); communityPosts.unshift({ id: Date.now(), title: document.getElementById('questionTitle').value, body: document.getElementById('questionBody').value, answers: [] }); renderPosts(); e.target.reset(); });
    forumPostsContainer.addEventListener('submit', e => { if (e.target.classList.contains('answer-form')) { e.preventDefault(); const post = communityPosts.find(p => p.id === parseInt(e.target.dataset.postId)); if (post) post.answers.push({ text: e.target.querySelector('textarea').value }); renderPosts(); } });

    // ===== WEATHER LOGIC =====
    const districtSearchInput = document.getElementById('districtSearchInput');
    const weatherResultsContainer = document.getElementById('weatherResultsContainer');
    districtSearchInput.addEventListener('input', e => { const searchTerm = e.target.value.toLowerCase(); if (!searchTerm) { weatherResultsContainer.innerHTML = `<p>Search for a district to see details.</p>`; return; } const result = odishaDistricts.find(d => d.name.toLowerCase().includes(searchTerm)); if (result) { weatherResultsContainer.innerHTML = `<h3>${result.name}</h3><div class="weather-grid-display"><div class="weather-card">🌡️ <strong>Temperature:</strong> ${result.temp}</div><div class="weather-card">🌬️ <strong>Wind:</strong> ${result.wind}</div><div class="weather-card">💧 <strong>Humidity:</strong> ${result.humidity}</div><div class="weather-card">🌧️ <strong>Rain:</strong> ${result.rain}</div><div class="weather-card full-width">🌱 <strong>Soil Type:</strong> ${result.soil}</div><div class="weather-card full-width">🌾 <strong>Ideal Crops:</strong> ${result.idealCrops}</div></div>`; } else { weatherResultsContainer.innerHTML = `<p>No district found matching "${e.target.value}".</p>`; } });

    // ===== MARKET DATA (RIGHT SIDEBAR) LOGIC =====
    const districtMarketSelector = document.getElementById('districtMarketSelector');
    function populateMarketSelector() { const districts = Object.keys(marketData); districtMarketSelector.innerHTML = districts.map(d => `<option value="${d}">${d}</option>`).join(''); }
    function updateMarketView(districtName) { const data = marketData[districtName]; if (!data) return; if (marketChart) marketChart.destroy(); marketChart = new Chart(document.getElementById('marketChart'), { type: 'bar', data: data.chartData, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } } } }); const tableContainer = document.getElementById('marketPriceTableContainer'); tableContainer.innerHTML = `<table class="price-table"><thead><tr><th>Crop</th><th>Price/Quintal</th></tr></thead><tbody>${data.prices.map(item => `<tr><td>${item.crop}</td><td>${item.price}</td></tr>`).join('')}</tbody></table>`; }
    districtMarketSelector.addEventListener('change', (e) => updateMarketView(e.target.value));

    // ===== FARM KART LOGIC =====
    function renderFarmKart() { document.getElementById('farmKartGrid').innerHTML = farmProducts.map(p => `<div class="product-card"><img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/200x150/cccccc/000000?text=Image+Not+Found';"><div class="product-info"><h4>${p.name}</h4><p>${p.price}</p><a href="${p.url}" target="_blank" class="buy-now-btn">Buy Now</a></div></div>`).join(''); }
    
    // ===== NOTIFICATIONS LOGIC =====
    const notificationsList = document.getElementById('notificationsList');
    const notificationsBtn = document.getElementById('notificationsBtn');
    
    function formatTimeAgo(date) {
        const seconds = Math.floor((new Date() - date) / 1000);
        let interval = seconds / 31536000;
        if (interval > 1) return Math.floor(interval) + " years ago";
        interval = seconds / 2592000;
        if (interval > 1) return Math.floor(interval) + " months ago";
        interval = seconds / 86400;
        if (interval > 1) return Math.floor(interval) + " days ago";
        interval = seconds / 3600;
        if (interval > 1) return Math.floor(interval) + " hours ago";
        interval = seconds / 60;
        if (interval > 1) return Math.floor(interval) + " minutes ago";
        return Math.floor(seconds) + " seconds ago";
    }

    function renderNotifications() {
        if (notifications.length === 0) {
            notificationsList.innerHTML = `<div class="empty-state"><i class="fas fa-check-circle" style="font-size: 2rem; margin-bottom: 10px;"></i><p>You're all caught up!</p></div>`;
        } else {
             notificationsList.innerHTML = notifications
                .map(n => `
                    <div class="notification-item ${n.read ? '' : 'unread'}">
                        <i class="fas ${n.icon} notification-icon"></i>
                        <div class="notification-content">
                            <div class="notification-title">${n.title}</div>
                            <p class="notification-message">${n.message}</p>
                            <div class="notification-time">${formatTimeAgo(n.timestamp)}</div>
                        </div>
                    </div>
                `).join('');
        }
        updateNotificationBadge();
    }
    
    function updateNotificationBadge() {
        const unreadCount = notifications.filter(n => !n.read).length;
        let badge = notificationsBtn.querySelector('.notification-badge');
        if (unreadCount > 0) {
            if (!badge) {
                badge = document.createElement('span');
                badge.className = 'notification-badge';
                notificationsBtn.appendChild(badge);
            }
            badge.textContent = unreadCount;
        } else {
            if (badge) {
                badge.remove();
            }
        }
    }

    document.getElementById('markAllReadBtn').addEventListener('click', () => {
        notifications.forEach(n => n.read = true);
        renderNotifications();
    });

    // ===== FORM SUBMISSION LOGIC =====
    document.getElementById('loginForm').addEventListener('submit', e => { e.preventDefault(); alert('Login Successful!'); closeModal(document.getElementById('loginModal')); e.target.reset(); });
    document.getElementById('signupForm').addEventListener('submit', e => { e.preventDefault(); alert('Sign up Successful!'); closeModal(document.getElementById('signupModal')); e.target.reset(); });

    // ===== INITIALIZATION =====
    function initialize() {
        updateFinanceSummary();
        renderTransactions();
        renderPosts();
        populateMarketSelector();
        updateMarketView(districtMarketSelector.value);
        renderFarmKart();
        renderNotifications();
    }

    initialize();
});
</script>
</body>
</html>
above is my html code
about us and notification not working.... here i am also giveing the js file... i have added a new feture of news update. add it with other dashboard items. with necesarry codes in html css and js, also make them workable. in news update, i want to show the latest news related to farming, govt schemes and odisha farming. make all the dashboard items little smaller to fit the new dashboard item in one line.

